(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{35:function(e,t,s){},67:function(e,t,s){},68:function(e,t,s){},71:function(e,t,s){"use strict";s.r(t);var a=s(0),i=s(1),l=s.n(i),n=s(16),c=s.n(n),r=(s(35),s(8)),d=s.n(r),o=s(17),h=s.n(o),j=s(54);s(63),s(64),s(65),s(66);var b="",p="",u=!1;class m extends l.a.Component{constructor(e){super(e),this.state={codeValue:"//start coding",isLoading:!1,flashing:!1},this.handleChangeCodeMirror=this.handleChangeCodeMirror.bind(this),this.handleSubmitCode=this.handleSubmitCode.bind(this),this.handleSubmitFlash=this.handleSubmitFlash.bind(this),this.parseOutput=this.parseOutput.bind(this)}componentDidMount(){var e=localStorage.getItem("codeValue");null===e&&(e="//start coding"),this.setState({codeValue:e})}parseOutput(e){return e=(e=(e=e.replaceAll("./public/programs-sent/","")).replaceAll("\\n","\n")).replace(/"+/g,"")}handleSubmitCode(e){e.preventDefault(),this.setState({isLoading:!0}),this.props.handleCompilingState(!0);const t=this.state.codeValue;d.a.post("http://192.168.0.197:8082/code",{codeSent:t}).then((e=>{if(e){const t=JSON.stringify(e.data.error),s=this.parseOutput(JSON.stringify(e.data.output));u="true"===t,b=s}})).catch((e=>{console.error("Post /code err "+e),alert("Something went wrong with the server.."),this.setState({isLoading:!1})})).finally((()=>{this.setState({isLoading:!1}),this.props.handleCompilingState(!1)}))}handleSubmitFlash(e){e.preventDefault(),this.setState({flashing:!0},(function(){d.a.post("http://192.168.0.197:8082/flash").then((e=>{p=this.parseOutput(e.data)})).catch((e=>{console.error("Post /flash err "+e),alert("Something went wrong with the server..")})).finally((()=>{this.setState({flashing:!1})}))}))}handleChangeCodeMirror(e){this.setState({codeValue:e}),localStorage.setItem("codeValue",this.state.codeValue)}render(){let e;return e=this.state.flashing?Object(a.jsxs)("div",{children:[Object(a.jsx)("div",{className:"conditional-div-text",children:"Flashing"}),Object(a.jsx)(h.a,{type:"bubbles",color:"#fffff",height:80,width:80})]}):Object(a.jsxs)("div",{children:[Object(a.jsx)("h2",{children:"Flash target to STM8"}),Object(a.jsx)("button",{type:"submit",className:"button-home",onClick:this.handleSubmitFlash,children:"Flash"})]}),this.state.isLoading?Object(a.jsxs)("div",{className:"conditional-div",children:[Object(a.jsx)("div",{className:"conditional-div-text",children:"Compiling code"}),Object(a.jsx)(h.a,{type:"bubbles",color:"#fffff",height:80,width:80})]}):Object(a.jsxs)("div",{id:"div-form",children:[Object(a.jsx)("form",{onSubmit:this.handleSubmitCode,children:Object(a.jsxs)("div",{id:"textarea-div",children:[Object(a.jsx)("label",{className:"label-description",children:"Or write your code here:"}),Object(a.jsx)("br",{}),"main.c",Object(a.jsx)(j,{defaultValue:localStorage.getItem("codeValue"),value:this.state.codeValue,options:{theme:"monokai",tabSize:5,indentUnit:5,mode:"javascript",lineNumbers:!0},onChange:this.handleChangeCodeMirror}),Object(a.jsx)("br",{}),Object(a.jsx)("input",{value:"Compile",type:"submit",className:"button-home"})]})}),Object(a.jsxs)("div",{id:"flexbox-compileout-video",children:[Object(a.jsxs)("div",{id:"compile-output-div",children:[Object(a.jsx)("br",{}),Object(a.jsx)("label",{className:"label-description",children:"Compile output"}),Object(a.jsx)("br",{}),Object(a.jsx)("textarea",{readOnly:!0,id:"compile-output-textarea",className:u?"compile-output-error":"compile-output-noerror",value:b}),Object(a.jsx)("br",{}),Object(a.jsx)("br",{}),e,Object(a.jsx)("br",{}),Object(a.jsx)("br",{}),Object(a.jsx)("label",{className:"label-description",children:"Flash output"}),Object(a.jsx)("br",{}),Object(a.jsx)("textarea",{readOnly:!0,id:"flash-output-textarea",value:p})]}),Object(a.jsxs)("div",{id:"video-div",children:[Object(a.jsx)("br",{}),Object(a.jsx)("p",{className:"label-description",children:"Visual output"}),Object(a.jsx)("img",{className:"video-class",src:"http://192.168.0.197:8081/",alt:"streaming-video"})]})]}),Object(a.jsx)("br",{})]})}}var x=m;class O extends l.a.Component{constructor(...e){super(...e),this.state={selectedFile:null,valid:!1},this.fileData=()=>this.state.selectedFile&&this.state.valid?Object(a.jsxs)("div",{children:[Object(a.jsx)("h2",{children:"File uploaded!"}),Object(a.jsxs)("p",{children:["Your file: ",this.state.selectedFile.name]})]}):Object(a.jsxs)("div",{children:[Object(a.jsx)("br",{}),Object(a.jsx)("h4",{children:"Choose source file then press upload"})]})}handleFileChange(e){this.setState({selectedFile:e.target.files[0]})}handleFileUpload(){const e=new FormData,t=["ihx","hex","ihex"];if(e.append("file",this.state.selectedFile),null!=this.state.selectedFile){var s=this.state.selectedFile.name.split(".")[1];t.includes(s)?d()({method:"post",url:"http://192.168.0.197:8082/load-file",data:e,headers:{"Content-Type":"multipart/form-data"}}).then((e=>{this.setState({valid:!0})})).catch((e=>{console.error("Error on uploading "+e),alert("Something went wrong..\nPlease try again."),this.setState({isLoading:!1})})):alert(`${this.state.selectedFile.name} is not valid.\nPlease add a .ihx, .hex or .ihex file!`)}else alert("Please add a file.")}handleFileClick(){this.setState({valid:!1})}render(){return this.props.isCompiling?"":Object(a.jsxs)("div",{children:[Object(a.jsx)("h2",{children:"Upload binary file"}),Object(a.jsxs)("div",{children:[Object(a.jsx)("input",{type:"file",onChange:this.handleFileChange.bind(this),onClick:this.handleFileClick.bind(this),accept:".ihx, .hex, .ihex"}),Object(a.jsx)("br",{}),Object(a.jsx)("br",{}),Object(a.jsx)("button",{className:"button-home",onClick:this.handleFileUpload.bind(this),children:"Upload"})]}),this.fileData()]})}}var g=O;s(67);class v extends l.a.Component{constructor(e){super(e),this.setCompileState=e=>{this.setState({isCompiling:e})},this.state={isCompiling:!1}}render(){return Object(a.jsxs)("div",{children:[Object(a.jsx)(g,{isCompiling:this.state.isCompiling}),Object(a.jsx)(x,{handleCompilingState:this.setCompileState.bind(this)})]})}}var N=v;class C extends l.a.Component{constructor(e){super(e),this.state={writeValue:this.props.pins},this.handleWriteValChange=this.handleWriteValChange.bind(this)}handleWriteValChange(e){this.props.getPinsCallback(this.state.writeValue);var t=e.target.value,s=this.state.writeValue;for(let a=0;a<s.length;a++)s[a].pinName===t.substr(1,3)&&(s[a].writeVal=t);this.setState({writeValue:s})}render(){return Object(a.jsxs)("div",{children:[Object(a.jsx)("label",{className:"left-text-write",children:"Write"}),Object(a.jsx)("ul",{className:"left-write-value-list",children:this.state.writeValue.map((({pinName:e,selected:t,writeVal:s,state:i},l)=>l<6?Object(a.jsx)("li",{children:Object(a.jsxs)("select",{className:"PD6"===e?"dropdownpd6-write-class":"PA2"===e?"dropdownpa2-write-class":"dropdown-class",name:"configuration",disabled:"o"===i[0]||!1===t,onChange:this.handleWriteValChange,children:[Object(a.jsx)("option",{id:"0",value:`0${e}`,children:"0"}),Object(a.jsx)("option",{id:"1",value:`1${e}`,children:"1"})]})},l):""))}),Object(a.jsx)("label",{className:"right-text-write",children:"Write"}),Object(a.jsx)("ul",{className:"right-write-value-list",children:this.state.writeValue.map((({pinName:e,selected:t,state:s},i)=>i>=6?Object(a.jsx)("li",{children:Object(a.jsxs)("select",{className:"dropdown-write-class",name:"configuration",disabled:"o"===s[0]||!1===t,onChange:this.handleWriteValChange,children:[Object(a.jsx)("option",{id:"0",value:`0${e}`,children:"0"}),Object(a.jsx)("option",{id:"1",value:`1${e}`,children:"1"})]})},i):""))})]})}}var f=C;class P extends l.a.Component{constructor(e){super(e),this.state={readValue:this.props.pins},this.handleSubmitRead=this.handleSubmitRead.bind(this)}componentDidMount(){this.readValues()}readValues(){var e=this.state.readValue;d.a.get("http://192.168.0.197:8082/get-values").then((t=>{const s=t.data;Object.keys(s).forEach((function(t){for(let a=0;a<e.length;a++)e[a].pinName===t&&(e[a].readVal=s[t])})),this.setState({readValue:e})})).catch((e=>{console.error("Get /get-values err:"+e)}))}handleSubmitRead(e){e.preventDefault(),this.readValues()}render(){return Object(a.jsxs)("div",{children:[Object(a.jsx)("label",{className:"right-text-read",children:"Read"}),Object(a.jsx)("ul",{className:"left-read-value-list",children:this.state.readValue.map((({pinName:e,readVal:t},s)=>s<6?Object(a.jsx)("li",{children:Object(a.jsx)("input",{readOnly:!0,type:"text",className:"PD6"===e?"dropdownpd6-read-box-class":"PA2"===e?"dropdownpa2-read-box-class":"read-box",value:t})},s):""))}),Object(a.jsx)("label",{className:"left-text-read",children:"Read"}),Object(a.jsx)("ul",{className:"right-read-value-list",children:this.state.readValue.map((({pinName:e,readVal:t},s)=>s>=6?Object(a.jsx)("li",{children:Object(a.jsx)("input",{readOnly:!0,type:"text",className:"read-box",value:t})},s):""))}),Object(a.jsx)("button",{type:"submit",id:"button-read",className:"button-controlpins",onClick:this.handleSubmitRead,children:"Read Values"})]})}}var V=P,w=s.p+"static/media/stm8blue-pinout.d05c0745.png";class S extends l.a.Component{constructor(e){super(e),this.state={pins:this.props.pins},this.handleInOutChange=this.handleInOutChange.bind(this),this.sendInOutChanges=this.sendInOutChanges.bind(this),this.getPins=this.getPins.bind(this)}getPins(e){this.setState({pins:e})}handleInOutChange(e){var t=e.target.value,s=this.state.pins;for(let a=0;a<s.length;a++)s[a].pinName===t.substr(1,3)&&(s[a].state=t,console.log(s[a].pinName));this.setState({pins:s})}sendInOutChanges(){d.a.post("http://192.168.0.197:8082/config",{pins:this.state.pins}).then((e=>{})).catch((e=>{console.error("Post /config err:",e)}))}render(){return Object(a.jsx)("div",{children:Object(a.jsxs)("div",{id:"stm8-schema",children:[Object(a.jsx)("br",{}),Object(a.jsx)("label",{className:"text-title",children:"STM8 pinout"}),Object(a.jsx)("br",{}),Object(a.jsx)("img",{className:"stm8schema-image",src:w,alt:"STM8 pinout"}),Object(a.jsx)("ul",{className:"left-configuration-list",children:this.state.pins.map(((e,t)=>t<6?Object(a.jsx)("li",{children:Object(a.jsxs)("select",{disabled:!e.selected,value:e.state,className:"PD6"===e.pinName?"dropdown-pd6-class":"PA2"===e.pinName?"dropdown-pa2-class":"dropdown-class",name:"configuration",onChange:this.handleInOutChange,children:[Object(a.jsxs)("option",{id:"1",value:`o${e.pinName}`,children:["Output ",e.pinName]}),Object(a.jsxs)("option",{id:"0",value:`i${e.pinName}`,children:["Input ",e.pinName]})]})},e.pinName):""))}),Object(a.jsx)("ul",{className:"right-configuration-list",children:this.state.pins.map(((e,t)=>t>=6?Object(a.jsx)("li",{children:Object(a.jsxs)("select",{disabled:!e.selected,value:e.state,className:"PD6"===e.pinName?"dropdown-pd6-class":"PA2"===e.pinName?"dropdown-pa2-class":"dropdown-class",name:"configuration",onChange:this.handleInOutChange,children:[Object(a.jsxs)("option",{id:"1",value:`o${e.pinName}`,children:["Output ",e.pinName]}),Object(a.jsxs)("option",{id:"0",value:`i${e.pinName}`,children:["Input ",e.pinName]})]})},e.pinName):""))}),Object(a.jsx)("label",{className:"right-text-config",children:"Config"}),Object(a.jsx)(f,{getPinsCallback:this.getPins,pins:this.state.pins}),Object(a.jsx)(V,{pins:this.state.pins}),Object(a.jsx)("label",{className:"left-text-config",children:"Config"}),Object(a.jsx)("button",{type:"submit",className:"button-controlpins",id:"button-config",onClick:this.sendInOutChanges,children:"Apply changes"})]})})}}var D=S;s(68);class y extends l.a.Component{constructor(e){super(e),this.state={pins:[{pinName:"PD4",selected:!1,state:"oPD4",readVal:"",writeVal:"0PD4"},{pinName:"PD5",selected:!1,state:"oPD5",readVal:"",writeVal:"0PD5"},{pinName:"PD6",selected:!1,state:"oPD6",readVal:"",writeVal:"0PD6"},{pinName:"PA1",selected:!1,state:"oPA1",readVal:"",writeVal:"0PA1"},{pinName:"PA2",selected:!1,state:"oPA2",readVal:"",writeVal:"0PA2"},{pinName:"PA3",selected:!1,state:"oPA3",readVal:"",writeVal:"0PA3"},{pinName:"PD3",selected:!1,state:"oPD3",readVal:"",writeVal:"0PD3"},{pinName:"PD2",selected:!1,state:"oPD2",readVal:"",writeVal:"0PD2"},{pinName:"PD1",selected:!1,state:"oPD1",readVal:"",writeVal:"0PD1"},{pinName:"PC7",selected:!1,state:"oPC7",readVal:"",writeVal:"0PC7"},{pinName:"PC6",selected:!1,state:"oPC6",readVal:"",writeVal:"0PC6"},{pinName:"PC5",selected:!1,state:"oPC5",readVal:"",writeVal:"0PC5"},{pinName:"PC4",selected:!1,state:"oPC4",readVal:"",writeVal:"0PC4"},{pinName:"PC3",selected:!1,state:"oPC3",readVal:"",writeVal:"0PC3"},{pinName:"PB4",selected:!1,state:"oPB4",readVal:"",writeVal:"0PB4"},{pinName:"PB5",selected:!1,state:"oPB5",readVal:"",writeVal:"0PB5"}]}}onChange(e){var t=e.target.value,s=this.state.pins;for(let a=0;a<this.state.pins.length;a++)this.state.pins[a].pinName===t&&(s[a].selected=!s[a].selected);this.setState({pins:s})}componentDidMount(){d.a.get("http://192.168.0.197:8082/pins-detected").then((e=>{const t=e.data.pinsDetected;var s=this.state.pins;for(let a=0;a<s.length;a++)Object.keys(t).forEach((function(e){s[a].pinName===e&&(s[a].selected=!0,s[a].state=t[e])}));this.setState({pins:s})})).catch((e=>{console.error("Get /pins-detected err "+e)}))}render(){return Object(a.jsxs)("div",{children:[Object(a.jsx)("label",{className:"label-description",children:"Select pins used in your program:"}),Object(a.jsx)("br",{}),Object(a.jsx)("br",{}),Object(a.jsxs)("ul",{className:"checkbox-pins",children:[this.state.pins.map((({pinName:e,selected:t},s)=>Object(a.jsx)("div",{className:"checkbox-div",children:Object(a.jsxs)("li",{children:[Object(a.jsx)("input",{className:"checkbox-square",type:"checkbox",checked:!!t,id:e,value:e,onChange:e=>this.onChange(e)}),Object(a.jsx)("label",{className:"checkbox-label",htmlFor:e,children:e})]})},s))),Object(a.jsx)("br",{})]}),Object(a.jsxs)("div",{id:"flexbox-schema-video-stimulus",children:[Object(a.jsxs)("div",{id:"video-div-stimulus",children:[Object(a.jsx)("br",{}),Object(a.jsx)("p",{className:"label-description",children:"Visual output"}),Object(a.jsx)("img",{className:"video-class",src:"http://192.168.0.197:8081",alt:"streaming-video"})]}),Object(a.jsx)(D,{pins:this.state.pins})]})]})}}var F=y,k=s(11),A=s(2);function I(){return Object(a.jsx)("nav",{children:Object(a.jsx)("div",{className:"navbar-container",children:Object(a.jsxs)("div",{className:"navbar-start",children:[Object(a.jsx)(k.b,{className:"navbar-item",to:"/",children:"Home"}),Object(a.jsx)(k.b,{className:"navbar-item",to:"/pins-control",children:"Pins Control"})]})})})}function M(){return Object(a.jsxs)("div",{children:[Object(a.jsx)("br",{}),Object(a.jsx)("br",{}),Object(a.jsx)("h1",{align:"center",className:"header-h1",children:"Remote Embedded Lab"})]})}function $(){return Object(a.jsxs)("div",{children:[Object(a.jsx)("br",{}),Object(a.jsx)("br",{}),Object(a.jsx)("hr",{}),Object(a.jsx)("footer",{children:"\xa92021 Tatarusanu Gabriel"})]})}class R extends l.a.Component{render(){return Object(a.jsx)("div",{className:"App",children:Object(a.jsxs)(k.a,{children:[Object(a.jsx)("br",{}),Object(a.jsx)(I,{}),Object(a.jsx)("div",{children:Object(a.jsxs)(A.c,{children:[Object(a.jsxs)(A.a,{exact:!0,path:"/",children:[Object(a.jsx)(M,{}),Object(a.jsx)(N,{}),Object(a.jsx)($,{})]}),Object(a.jsxs)(A.a,{path:"/pins-control",children:[Object(a.jsx)(M,{}),Object(a.jsx)(F,{}),Object(a.jsx)($,{})]})]})})]})})}}var B=R;c.a.render(Object(a.jsx)(B,{}),document.getElementById("root"))}},[[71,1,2]]]);
//# sourceMappingURL=main.0028561e.chunk.js.map